# lychee link checker configuration
# https://github.com/lycheeverse/lychee

# base_url is required only so lychee can construct URLs from root-relative
# paths (e.g. /user-guide/…, /docs/assets/…) without crashing. All resolved
# docs.credal.ai URLs are immediately excluded below — we never actually fetch
# them. Internal link correctness is Fern's job (fern-check CI step).
base_url = "https://docs.credal.ai"

# Accepted HTTP status codes — treat these as "link is alive"
#   200..=206  normal success range
#   429        rate-limited by the server; site is up, just throttling bots
accept = "200..=206,429"

# Per-request timeout in seconds
timeout = 30

# Retry transient failures before marking a link broken
max_retries = 3

# Parallel requests (keep moderate to avoid triggering rate-limits)
max_concurrency = 10

# Exclude URLs matching these patterns (regex).
# These are intentionally skipped because they require auth, expire, or
# block headless clients — their breakage is not actionable in CI.
exclude = [
  # All docs.credal.ai URLs — covers root-relative paths resolved via base_url
  # (/user-guide/…, /docs/assets/…, /api-reference/…) and any explicit links.
  # Fern's own checker validates internal navigation; lychee only checks external links.
  "^https://docs\\.credal\\.ai/",

  # Relative Fern internal links (.mdx extension) — valid for Fern's nav
  # resolver but not real URLs.
  "\\.mdx(#.*)?$",

  # Google Docs / Drive require a Google login
  "^https://docs\\.google\\.com/",
  "^https://drive\\.google\\.com/",

  # SharePoint requires a Microsoft login
  "^https://.*\\.sharepoint\\.com/",

  # Zoom webinar registration links expire after the event
  "^https://.*zoom\\.us/webinar/",

  # YouTube and Loom embed URLs routinely return 403 to headless clients
  "^https://www\\.youtube\\.com/embed/",
  "^https://www\\.loom\\.com/embed/",
]
