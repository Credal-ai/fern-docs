service:
  base-path: /v1/agents
  auth: true
  endpoints:
    sendMessage:
      path: /sendMessage
      method: POST
      request:
        name: SendMessageRequest
        body:
          properties:
            message:
              type: string
              docs: |
                The message you want to send to 
                your copilot.
            userEmail:
              type: string
              docs: |
                The user profile you want to use
                when sending the message.
            conversationId:
              type: optional<uuid>
              docs: |
                Conversation in which to send
                the message. Conversation ID is
                returned after initial message. Optional.
      response: SendMessageResponse
      examples:
        - name: Example0
          request:
            message: Is Credal SOC 2 compliant?
            userEmail: ravin@credal.ai
          response:
            body:
              type: messageReply
              policy_triggers: []
              responseChunks:
                - message: ""
                  dataChunk: "Based on the context provided, Credal is SOC 2 compliant..."
              warnings: []
              parallelConversationContexts: []
              activitySourceIdsForAudit: []
              inserted_audit_log:
                id: 5842804e-ffbe-4f8d-873e-f007fff93440

types:
  SendMessageResponse:
    union:
      messageReply:
        type: MessageReply
        docs: |
          Returned when there is a reply 
          fetched from the copilot.
      messageBlocked:
        type: MessageBlocked
        docs: |
          Returned when Credal detects possible 
          infosec violations and blocks the message.

  MessageReply:
    properties:
      policy_triggers: list<PolicyTrigger>
      conversationId: optional<uuid>
      responseChunks: list<ResponseChunk>
      warnings: list<string>
      parallelConversationContexts: list<string>
      activitySourceIdsForAudit: list<string>
      inserted_audit_log: InsertedAuditLog

  ResponseChunk:
    properties:
      message: string
      dataChunk: string

  InsertedAuditLog:
    properties:
      id: uuid

  MessageBlocked:
    properties:
      policy_triggers: list<PolicyTrigger>
      conversationId: optional<uuid>
      blocks: list<string>
      warnings: list<string>
      inserted_audit_log: InsertedAuditLog

  PolicyTrigger:
    properties:
      id: string
      name: string
      description: string
