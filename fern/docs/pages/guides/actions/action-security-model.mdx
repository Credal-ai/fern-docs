### Ground Truth

No users can execute outside the scope of the credentials and permissions that admins and data owners have explicitly granted.

### Quick Definitions

- **Action Provider**: An external system that an Action let you interact with, ex. Jira or Okta.
- **Action Template**: A type of action available for an Action Provider, ex. "Add User to Okta Group" or "Create Jira Ticket".
- **Action**: An instance of an Action Template with paramaters configured by a user, ex. "Create IT Support Request Jira Ticket in SI Project".
- **Invoking an Action**: Prompting an Agent to decide that an Action should be taken.
- **Executing the Action**: Running the Action using your permissions/scopes.

### FAQ

- **Where are actions invoked?**: In requests made to Agents that have permission to use the Action, as defined in Agent Access configuration.
- **Who can invoke actions?**: Users who can access an Agent that the action is attached to. For specific actions with more regulated providers, users must be in the End User Access configuration in an Action's Deployment settings to invoke the action.
- **Who can execute actions?**: The Action's approvers. If there are no approvers, invokers.
- **Which user-level providers can I OAuth into?**: All enabled by your organization's admins. Admins can prevent shadow IT connections to non-approved providers by disabling those actions in the [Admin Data Sources](https://app.credal.ai/admin/data-sources#action-configuration) tab.
<!-- - **How do we infer resource level access for org-wide no perm providers and arbitrary webhooks?**: Admins can vet certain groups/users as executors of the action. No one else can configure these granular access settings. -->

### User-scoped Credential Action Providers

The vast majority of Credal's Action Providers are **user-scoped**. By this, it means that the credentials of the user executing the action are used when accessing the Action Provider. Thus, in a standard action configuration¹, it's impossible for the invoking user to perform an operation that they were not already authorized to do so directly in the provider, without Credal.

These Action Providers, including Salesforce, Github, and Notion, are considered low-risk and thus have minimal restrictions.

| Operation                       | Who is Authorized |
| ---------------------------- | -------------------------- |
| **Create Action**            | Anyone                     |
| **Edit/Delete/Share Action** | Action Collaborator        |
| **Publish to Specific Agents** | Action Collaborator      |
| **Publish to All Org Agents** | Org Admin                 |
| **Invoke Action**            | Anyone with access to an Agent with the action attached |

### Action-scoped Credential Action Providers

For providers, the access pattern centers not around individual users, but around different **credentials**¹. These credentials are attached directly to actions, allowing anyone with **End-User Access** to that action to use the associated credentials.

This is an unusual access pattern and considered to be higher-risk than user-scoped actions usage because it enables users to perform actions that they may not have permissions for in the underlying system. Thus, there is an extra layer of security controls in Credal's system for these providers' actions: end-user allowlisting.

End-user allowlists allow an action collaborator to limit which users can execute the action, regardless of what agents the action is published to.

Providers in this category include Looker and Snowflake.

_¹There are instances where you'd want to have multiple credentials for a provider used in different actions, such as where you need a credential per role in each system._

#### Arbitrary Fetch with Credential

One special case of an action-scoped credential provider is our OpenAPI action provider, which contains an action ("Webhook") that can be configured to make an arbitrary API request. Due to the risk posed by arbitrary changes to the spec, only admins can modify and publish these actions.

### Multi User Operations

An operation is a multi-user operation if the approval to carry out a given action in the workflow is someone other than the sender. Credal has HITL approval mechanisms that you can configure to use your credentials or permissions scopes in a cross-functional or multi-user operation. A request that is not initiated by you can only use credentials/scopes if you give explicit permission to do so.

### Approval flow

- If you provide approval for an Action, you are allowing Credal to use your credentials to carry out that one specific action. Your credentials are granted for only that action, and any further use must go through your explicit permission.
- The guard-rails that already exist in the underlying systems remain the ultimate source of truth; Credal just adds a programmable, fully-logged wrapper on top. Credal never manufactures new privileges out of thin air and is simply automating the same approval you would have done manually (like a ping in Slack or a tap on the shoulder)—except now with a perfect audit trail.
- For these workflows, the approver—not the requester—is on the hook in the audit trail.
- If permissions enhancement takes place anywhere in an Agent, that agent cannot be deployed to end users by anyone other than a Credal admin.

### Considerations when permissions are enhanced in a request

- The “write” Actions are typically void and don’t bring in sensitive information into the chat history, but the “read” Actions pose DLP risks. Note: We do not recommend expanding access permissions in Agents directly available to end users, rather you should use Agent-to-Agent handoffs for this (see below). Nonetheless, the below features and considerations make multi-user requests airtight in Credal.
- Let’s say you need to fetch specific sensitive data from a database to answer an employee’s yes/no/etc. question, but they are not allowed to see the raw underlying data. There are a few risks associated with permissions enhancement when automating these sorts of Enterprise operations.
  - A user seeing the sensitive retrieved information in the context window which is visible to participants of the conversation.
    - In order to properly manage when your credentials are used, we strongly recommend creating separate agents for each user role involved in the operation. The user-facing agent can then handoff requests to the Agent that will perform sensitive read operations under an approver’s credentials. If a conversation is deemed to be sensitive, end users will not be allowed to view them as the context windows may contain sensitive data used to derive responses. Only the approvers and whomever they share the conversation with can view it.
    - If you choose to escalate permissions in a conversation between an end user and an Agent, any retrieved data from an action will be redacted from the conversation context window and will only be visible if viewed by the approver.
  - Adversarial prompt injection (user asking for something they shouldn’t be)
    - For fields associated with user identity, Credal will assign caller-set parameters to hard code the sender’s email, user ID, requesting agent ID, etc. This will guarantee that Bob can’t ask for Mary’s salary information, for example.
    - Caller set parameters are not considered credentials, so an approver’s metadata is not used as the caller set parameters, it will always be the original sender.
  - Mistakes the agent makes or indirect leakage through summaries (hallucinations and implied information)
    - All Actions in an Agent that undergo permission escalation must have the Action Release Gate turned on. If a builder wants to turn it off for whatever reason, there must be a justification provided with that toggle off. The ARG will require an egress approval step from the Agent owner(s). This way, humans can use their expertise and judgment to ensure DLP.

All three of these provisions together make your multi-user workflows airtight and prevent any unauthorized access, visibility, or indirect leakage.
